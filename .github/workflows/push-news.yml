name: Push Market News
on:
  workflow_dispatch:
  schedule:
    - cron: "*/5 13-20 * * 1-5"
env:
  APP_URL: "https://v0-finviz-gapper.vercel.app"   # <-- replace
jobs:
  push:
    runs-on: ubuntu-latest
    steps:
      - name: Build news JSON (demo)
        run: |
          cat > news.json <<'JSON'
          {
            "generatedAt": null,
            "items": [
              {
                "ticker": "BLNE",
                "headline": "BLNE posts strong guidance",
                "url": "https://example.com/blne-guidance",
                "source": "PRNewswire",
                "published": "2025-09-14T20:25:00Z"
              }
            ]
          }
          JSON
      - name: POST news
        run: |
          curl -sS -X POST "$APP_URL/api/news" \
            -H "content-type: application/json" \
            -H "x-api-key: ${{ secrets.SCORES_API_KEY }}" \
            --data @news.json
